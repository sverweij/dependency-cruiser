[
  {
    "title": "empty module",
    "input": {
      "fileName": "test/main/fixtures/cruise-reporterless/commonjs/empty.js"
    },
    "expected": [
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/empty.js",
        "orphan": true,
        "dependencies": [],
        "valid": true
      }
    ]
  },
  {
    "title": "root_one unfiltered",
    "input": {
      "fileName": "test/main/fixtures/cruise-reporterless/commonjs/root_two.js"
    },
    "expected": [
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/root_two.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./shared",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/shared.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "./somedata.json",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/somedata.json",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "./two_only_one",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/two_only_one.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "http",
            "resolved": "http",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/somedata.json",
        "followable": false,
        "matchesDoNotFollow": false,
        "couldNotResolve": false,
        "coreModule": false,
        "dependencyTypes": ["local"],
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "http",
        "followable": false,
        "matchesDoNotFollow": false,
        "couldNotResolve": false,
        "coreModule": true,
        "dependencyTypes": ["core"],
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/shared.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "path",
        "followable": false,
        "matchesDoNotFollow": false,
        "couldNotResolve": false,
        "coreModule": true,
        "dependencyTypes": ["core"],
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/two_only_one.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./sub/dir",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/sub/dir.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/sub/dir.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./depindir",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/sub/depindir.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/sub/depindir.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      }
    ]
  },
  {
    "title": "root_one node_modules filtered out",
    "input": {
      "fileName": "test/main/fixtures/cruise-reporterless/commonjs/root_one.js",
      "options": {
        "exclude": "node_modules"
      }
    },
    "expected": [
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/root_one.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./one_only_one",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/one_only_one.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "./one_only_two",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/one_only_two.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "./shared",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/shared.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "./sub/dir",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/sub/dir.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "fs",
            "resolved": "fs",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "fs",
        "followable": false,
        "matchesDoNotFollow": false,
        "couldNotResolve": false,
        "coreModule": true,
        "dependencyTypes": ["core"],
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/one_only_one.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "path",
        "followable": false,
        "matchesDoNotFollow": false,
        "couldNotResolve": false,
        "coreModule": true,
        "dependencyTypes": ["core"],
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/one_only_two.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/shared.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/sub/dir.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./depindir",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/sub/depindir.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "circular": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          },
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/sub/depindir.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "path",
            "resolved": "path",
            "moduleSystem": "cjs",
            "coreModule": true,
            "dependencyTypes": ["core"],
            "dynamic": false,
            "circular": false,
            "followable": false,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true
          }
        ],
        "valid": true
      }
    ]
  },
  {
    "title": "circular dependency (one step)",
    "input": {
      "fileName": "test/main/fixtures/cruise-reporterless/commonjs/circular.js",
      "options": {
        "validate": true,
        "ruleSet": {
          "forbidden": [
            {
              "name": "no-circular",
              "severity": "info",
              "from": {},
              "to": { "circular": true }
            }
          ]
        }
      }
    },
    "expected": [
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/circular.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./pointed-to-by-circular",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/pointed-to-by-circular.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true,
            "circular": false
          },
          {
            "module": "./ralucric",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/ralucric.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": false,
            "circular": true,
            "cycle": [
              "test/main/fixtures/cruise-reporterless/commonjs/ralucric.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circular.js"
            ],
            "rules": [
              {
                "name": "no-circular",
                "severity": "info"
              }
            ]
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/pointed-to-by-circular.js",
        "orphan": false,
        "dependencies": [],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/ralucric.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./circular",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/circular.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": false,
            "circular": true,
            "cycle": [
              "test/main/fixtures/cruise-reporterless/commonjs/circular.js",
              "test/main/fixtures/cruise-reporterless/commonjs/ralucric.js"
            ],
            "rules": [
              {
                "name": "no-circular",
                "severity": "info"
              }
            ]
          }
        ],
        "valid": true
      }
    ]
  },
  {
    "title": "circular dependency (more steps)",
    "input": {
      "fileName": "test/main/fixtures/cruise-reporterless/commonjs/points-to-circle-one.js",
      "options": {}
    },
    "expected": [
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/points-to-circle-one.js",
        "dependencies": [
          {
            "module": "./circle-one",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true,
            "circular": false
          }
        ],
        "orphan": false,
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js",
        "dependencies": [
          {
            "module": "./circle-two",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/circle-two.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true,
            "circular": true,
            "cycle": [
              "test/main/fixtures/cruise-reporterless/commonjs/circle-two.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-three.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js"
            ]
          }
        ],
        "orphan": false,
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/circle-two.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./circle-three",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/circle-three.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true,
            "circular": true,
            "cycle": [
              "test/main/fixtures/cruise-reporterless/commonjs/circle-three.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-two.js"
            ]
          }
        ],
        "valid": true
      },
      {
        "source": "test/main/fixtures/cruise-reporterless/commonjs/circle-three.js",
        "orphan": false,
        "dependencies": [
          {
            "module": "./circle-one",
            "resolved": "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js",
            "moduleSystem": "cjs",
            "coreModule": false,
            "dependencyTypes": ["local"],
            "dynamic": false,
            "followable": true,
            "exoticallyRequired": false,
            "matchesDoNotFollow": false,
            "couldNotResolve": false,
            "valid": true,
            "circular": true,
            "cycle": [
              "test/main/fixtures/cruise-reporterless/commonjs/circle-one.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-two.js",
              "test/main/fixtures/cruise-reporterless/commonjs/circle-three.js"
            ]
          }
        ],
        "valid": true
      }
    ]
  }
]
